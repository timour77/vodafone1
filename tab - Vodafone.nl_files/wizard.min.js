!function(r,e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(r,t)}):"object"==typeof exports?e(r,require("jquery")):e(r,r.jQuery||r.Zepto)}(this,function(r,e){"use strict";function t(){for(var r=n,e=0;e<arguments.length;++e)r+=""+arguments[e];return r}var o="vf-wizard",n=o,i=(/iPad|iPhone|iPod/.test(navigator.platform),window.attachEvent&&!window.addEventListener),l=function(){for(var r="transition WebkitTransition MozTransition OTransition msTransition".split(" "),e=document.createElement("div"),t=0;t<r.length;t++)if(e&&void 0!==e.style[r[t]])return r[t];return!1}(),p=function(){for(var r="transform WebkitTransform MozTransform OTransform msTransform".split(" "),e=document.createElement("div"),t=0;t<r.length;t++)if(e&&void 0!==e.style[r[t]])return r[t];return!1}(),s=e.map(["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd"],function(r){return r+"."+n}).join(" "),a=function(){function r(r){var n,l;return i?void log("-- vf-wizard: IE8 is not supported. Are you seriously still using it??"):(A(r),void o().done(function(r,o){null!=o&&j(o.data[0]),n=k(N.isConsumer?r.introConsumerTitle||r.introTitle:r.introBusinessTitle||r.introTitle),l=k(N.isConsumer?r.introConsumerText||r.introText:r.introBusinessText||r.introText),r&&(A({theme:r.theme,introIcon:r.introIcon,introTitle:n,introText:l,introButtonText:r.introButtonText}),S=r.points),a(),U.addClass(t("--init")),null!==N.theme&&e("html").addClass(t("--theme-",N.theme)),L.READY=!0,e.publish(t(".","ready"))}).fail(function(r){log("-- vf-wizard: failed to load or parse valid JSON. Please check the `url` option.")}))}function o(){var r=e.Deferred();return e.when(p(N.url),p(N.externalUrl)).done(function(e,t){e?r.resolve(e,t):r.reject()}).fail(r.reject),r.promise()}function p(r){var t=e.Deferred();return null!=r?e.getJSON(r).done(function(r){r&&!r.readyState?t.resolve(r):t.reject()}).fail(t.reject):t.resolveWith(!1),t.promise()}function a(){I||(I=e("<div>").addClass(t()),I.append(e("<div>").addClass(t("__backdrop"))),I.append(P.render().$el),J=e('<section class="'+t("__intro")+'">'+(N.introIcon?'<img src="'+N.introIcon+'" alt=""/>':"")+'<h1 class="'+t("__intro-title")+'">'+N.introTitle+"</h1>"+N.introText+'<button class="'+t("__intro-btn")+'">'+N.introButtonText+'</button><button class="'+t("__intro-close-btn")+'">'+N.introCloseButtonText+"</button></section>"),I.append(J),I.append(e("<div>").addClass(t("__instructions")).html('<span class="'+t("__instructions-orb")+'"></span>Klik op de bolletjes voor meer informatie')),I.append(e("<button>").addClass(t("__close-button"))),I.append(e('<button class="'+t("__prev")+'"><i class="icon-chevron-left"></i></button>')),I.append(e('<button class="'+t("__next")+'"><i class="icon-chevron-right"></i></button>')),K=e('<section class="'+t("__content")+'"><header class="'+t("__content-header")+'"><h1></h1><button class="'+t("__content-close")+'"></button></header><div class="'+t("__content-inner")+'"></div></section>'),I.append(K),U.append(I))}function u(){var r=e(O.POINT_DATA);r.each(function(){v(e(this))}),S.length>0&&Q.forEach(function(r){for(var e=S.length-1;e>=0;e--)S[e].id===r.id&&(N.isConsumer?(r.attrs.title=S[e].consumerTitle||S[e].title||"",r.attrs.text=S[e].consumerText||S[e].text||""):(r.attrs.title=S[e].businessTitle||S[e].title||"",r.attrs.text=S[e].businessText||S[e].text||""),r.attrs.title=k(r.attrs.title),r.attrs.text=k(r.attrs.text),r.tag=S[e].tag)})}function v(r,e,t){e="undefined"!=typeof e?"string"==typeof e?{id:e}:e:{},t="undefined"!=typeof t&&t;var o=new h(r,e),n=!1;o&&(n=Q.add(o)),t&&n&&o.render()&&I.append(o.$el)}function y(r,e){e="undefined"!=typeof e&&e;var t=Q.get(r);e?Q.remove(r):t.remove()}function d(){Q.forEach(function(r){r.remove()})}function g(){var r=0;Q.sort().forEach(function(e){var t=e.render(++r);t?I.append(t.$el):--r})}function m(r,o){var n,i;return o="undefined"==typeof o||o,(n=Q.get(r))?(R=n.id,Q.setCurrent(R),n.isTargetVisible()?(K.find("h1").text(n.attrs.title||""),K.find(O.CONTENT).html(n.attrs.text||""),U.toggleClass(t("--content-open"),o),i=n.attrs.top-150,x(i),P.moveTo(n),e.publish(t(".point"),e.extend({},{id:n.id},n.attrs)),void e.publish(t(".point",":",n.id),e.extend({},{id:n.id},n.attrs))):void m(Q.next(R).id,o)):void log("-- vf-wizard: could not find point at id "+r)}function x(r){e("html, body").stop().animate({scrollTop:r},500)}function A(r,e){if("object"==typeof r)for(var t in r)b(t,r[t]);else"string"==typeof r&&b(r,e)}function b(r,e){r in N&&null!==e&&"undefined"!=typeof e?N[r]=e:log("-- vf-wizard: invalid option "+r)}function j(r,e){var t,o;if("object"==typeof r)for(t in r)o=r[t],null!==o&&"undefined"!=typeof o&&(T[t]=o);else"string"==typeof r&&null!==e&&"undefined"!=typeof e&&(T[r]=e)}function k(r){var t,o=null!=window.Handlebars;return o||log("-- vf-wizard: Handlebars is not loaded, please include it to support tag overloading"),!o||e.isEmptyObject(T)?r:(t=window.Handlebars.compile(r,{noEscape:!0}))(T)}function q(r){return L.READY?(u(),Q.count()?(I.toggleClass(t("--shown"),!0),e.publish(t(".show")),void(N.skipIntro===!0&&z())):void log("-- vf-wizard: cannot start wizard, no items to display")):void log("-- vf-wizard: the wizard is not ready, did you forget to call init() or add any points?")}function w(){B(),Q.forEach(function(r){r.$el&&r.$el.removeClass(t("__point--in"))}),l?I.on(s,function(){I.off(s),d()}):d(),I.toggleClass(t("--shown"),!1),U.toggleClass(t("--started"),!1),R=null,L.STARTED=!1,e.publish(t(".hide"))}function z(){if(g(),e(O.PREV).toggle(Q.count()>1),e(O.NEXT).toggle(Q.count()>1),U.addClass(t("--started")),L.STARTED=!0,e.publish(t(".start")),N.startAtPoint!==!1)m(N.startAtPoint);else{var r,o=Number.MAX_VALUE;Q.forEach(function(e){e.attrs.top<o&&(o=e.attrs.top,r=e)}),o-=150,o>0&&x(o)}}function B(){P.hide(),U.toggleClass(t("--content-open"),!1),Q.get(R)!==!1&&Q.get(R).setCurrent(!1),L.STARTED=!1,e.publish(t(".stop"))}function C(){Q.reset()}function D(r){VF.core.tag().trackButtonClick("my:rekeningen:rekening:uitleg stop"),r.preventDefault(),w()}function E(r){VF.core.tag().trackButtonClick(e(r.target).data("tag")),r.preventDefault(),m(e(r.target).data("id"))}function F(r){VF.core.tag().trackButtonClick("my:rekeningen:rekening:uitleg start"),r.preventDefault(),z()}function G(r){if(L.READY&&(Q.forEach(function(r){r.update()}),L.STARTED&&null!==R)){P.moveTo(Q.get(R));var e=R;m(e,U.hasClass(t("--content-open")))}}function H(r){var e=r.keyCode;switch(e){case 27:w();break;case 37:case 38:L.STARTED&&m(Q.previous(R).id);break;case 39:case 40:L.STARTED&&m(Q.next(R).id)}}var I,J,K,L={READY:!1,STARTED:!1},M={url:null,externalUrl:null,theme:"blue",isConsumer:!0,skipIntro:!1,startAtPoint:!1,introIcon:"/_assets/img/_core/rekening-header-icon-l.png",introTitle:"Standaard titel",introText:"Standaard introductie tekst",introButtonText:"Starten",introCloseButtonText:"Nee bedankt"},N=e.extend({},M),O={POINT:"."+t("__point"),POINT_DATA:"[data-"+t("-point")+"]",CONTENT:"."+t("__content-inner"),PREV:"."+t("__prev"),NEXT:"."+t("__next")},P=new c,Q=new f,R=null,S={},T={},U=e("body");return e(document).on("click."+n,"."+t("__close-button"),D).on("click."+n,"."+t("__intro-btn"),F).on("click."+n,"."+t("__intro-close-btn"),function(r){VF.core.tag().trackButtonClick("my:rekeningen:rekening:intro stop"),r.preventDefault(),w()}).on("click."+n,"."+t("__point"),E).on("click."+n,"."+t("__next"),function(r){VF.core.tag().trackButtonClick("my:rekeningen:rekening:uitleg volgende"),r.preventDefault(),m(Q.next(R).id)}).on("click."+n,"."+t("__prev"),function(r){VF.core.tag().trackButtonClick("my:rekeningen:rekening:uitleg vorige"),r.preventDefault(),m(Q.previous(R).id)}).on("click."+n,"."+t("__content-close"),function(r){VF.core.tag().trackButtonClick("my:rekeningen:rekening:content stop"),r.preventDefault(),B()}).on("keydown."+n,H),e(window).on("resize."+n+" orientationchange."+n,VF.core.debounce(G,250)),{init:r,show:q,hide:w,reset:C,set:A,setVars:j,addPoint:v,removePoint:y,setComparator:function(r){Q.setComparator(r)},on:function(r,o){e.subscribe(t(".",r),o)},off:function(r,o){e.unsubscribe(t(".",r),o)}}},c=function(){this.el=null,this.$el=null,this.padding=12,this.render=function(){return this.el=document.createElement("div"),this.el.className=t("__helper"),this.$el=e(this.el),this},this.moveTo=function(r){if(r){var e=parseInt(r.attrs.width)+2*this.padding,t=parseInt(r.attrs.height)+2*this.padding,o=parseInt(r.attrs.left)-this.padding,n=parseInt(r.attrs.top)-this.padding;this.el.style.width=e+"px",this.el.style.height=t+"px",p!==!1?this.el.style[p]="translateX("+o+"px) translateY("+n+"px)":(this.el.style.top=o+"px",this.el.style.left=n+"px")}},this.hide=function(){this.el.style.removeProperty?(this.el.style.removeProperty("width"),this.el.style.removeProperty("height")):(this.el.style.removeAttribute("width"),this.el.style.removeAttribute("height"))}},f=function(){this.collection=[],this.count=function(){return this.collection.length},this.add=function(r){return!!r.hasTarget()&&(!this.get(r.id)&&(this.collection.push(r),!0))},this.get=function(r){for(var e=0;e<this.collection.length;e++)if(this.collection[e].id===r)return this.collection[e];return!1},this.findBy=function(r,e){for(var t=0;t<this.collection.length;t++)if(this.collection[t].attrs.hasOwnProperty(r)&&this.collection[t].attrs[r]===e)return this.collection[t];return!1},this.previous=function(r){for(var e=0;e<this.collection.length;e++)if(this.collection[e].id===r)return e-1<0?e=this.collection.length-1:e-=1,this.collection[e]},this.next=function(r){for(var e=0;e<this.collection.length;e++)if(this.collection[e].id===r)return e+1>=this.collection.length?e=0:e++,this.collection[e]},this.remove=function(r){for(var e=0;e<this.collection.length;e++)this.collection[e].id===r&&(this.collection[e].remove(),this.collection.splice(e,1))},this.comparator=function(r,e){var t=r.$target.offset(),o=e.$target.offset();return t.top<o.top?-1:t.top>o.top?1:0},this.sort=function(){var r=this.comparator;return"function"==typeof r&&(this.collection=this.collection.sort(r)),this},this.reset=function(){for(var r=0;r<this.collection.length;r++)this.collection[r].remove(),delete this.collection[r];this.collection=[]},this.setCurrent=function(r){for(var e=0;e<this.collection.length;e++)this.collection[e].setCurrent(this.collection[e].id===r)},this.setComparator=function(r){this.comparator=r},this.forEach=function(r){for(var e=0;e<this.collection.length;e++)r(this.collection[e])}},h=function(r,e){this.id=null,this.$el=null,this.$target=r,this.attrs="undefined"!=typeof e?e:{},this.init()};h.prototype={constructor:h,_uniqueId:1e3,pointSize:28,init:function(){"string"==typeof this.$target&&(this.$target=e(this.$target)),this.$target.length&&(this.id=this.attrs.id||this.$target.data(t("-point"))||++this._uniqueId+"",delete this.attrs.id)},render:function(r){var o,n=this;return this.$target.length&&this.isTargetVisible()?(this.$el=e("<a>").addClass(t("__point")).css(this.pointPosition()).data({id:this.id,tag:this.tag}),o=r?1e3*(.7+r/4):0,setTimeout(function(){n.$el.addClass(t("__point--in"))},o),this.attrs.idx=r,this):this},hasTarget:function(){return!!this.$target.length},isTargetVisible:function(){var r=this.$target[0].getBoundingClientRect();return this.$target.is(":visible")&&0!==r.width&&0!==r.height},update:function(){this.$el&&this.$el.css(this.pointPosition())},remove:function(){this.$el&&(this.$el.remove(),this.$el=null)},setCurrent:function(r){this.$el&&(this.$el.toggleClass(t("__point--current"),r),this.$el.css(this.pointPosition(r)))},pointPosition:function(r){this.attrs=e.extend({},this.attrs,this.targetDimensions());var t=this.attrs.top+(r?this.attrs.height-this.pointSize/2+12:this.attrs.height/2-this.pointSize/2);return{left:this.attrs.left+this.attrs.width/2-this.pointSize/2,top:t}},targetDimensions:function(){var r=this.$target.offset();return{top:Math.round(r.top),left:Math.round(r.left),width:Math.round(this.$target.outerWidth()),height:Math.round(this.$target.outerHeight())}}},r.VF.namespace("VF.Wizard"),r.VF.Wizard=new a});